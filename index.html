<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pew Digital Business Card</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --pew-blue: #002D62; }
        body { 
            font-family: 'Segoe UI', Tahoma, sans-serif; display: flex; flex-direction: column; align-items: center; 
            min-height: 100vh; margin: 0; background-color: var(--pew-blue); 
            background-image: url('https://raw.githubusercontent.com/monkeyjedi/PewBusCards/main/Pew_Background-2023-2%20.png');
            background-size: cover; background-position: center; background-attachment: fixed;
        }
        .card { 
            background: rgba(255, 255, 255, 0.98); padding: 25px; border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); max-width: 400px; width: 90%; text-align: center; margin: 30px 0;
        }
        input { 
            width: 100%; padding: 12px; margin: 6px 0; border: 1px solid #ccc; 
            border-radius: 8px; box-sizing: border-box; font-size: 16px;
        }
        #qrcode { margin-top: 15px; display: flex; justify-content: center; padding: 15px; background: white; border-radius: 10px; border: 1px solid #eee; }
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        button { flex: 1; padding: 14px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .primary-btn { background-color: var(--pew-blue); color: white; }
        .reset-btn { background-color: #f1f1f1; color: #666; width: 100%; margin-top: 10px; }
        .pew-logo { font-weight: 900; color: var(--pew-blue); letter-spacing: 3px; font-size: 1.6em; margin-bottom: 5px; }
    </style>
</head>
<body>

<div class="card">
    <div class="pew-logo">PEW</div>
    <p style="margin: 0 0 15px 0; color: #666; font-size: 0.9em;">Digital Contact Creator</p>
    
    <input type="text" id="fname" placeholder="First Name" oninput="generateQR()">
    <input type="text" id="lname" placeholder="Last Name" oninput="generateQR()">
    <input type="text" id="pro" placeholder="Pronouns (e.g. he/him)" oninput="generateQR()">
    <input type="text" id="comp" value="Pew" placeholder="Company" oninput="generateQR()">
    <input type="text" id="title" placeholder="Job Title" oninput="generateQR()">
    <input type="email" id="email" placeholder="Work Email" oninput="generateQR()">
    <input type="tel" id="phone" placeholder="Phone (e.g. +1 234 567 890)" oninput="generateQR()">
    <input type="text" id="li" placeholder="LinkedIn URL" oninput="generateQR()">

    <div id="qrcode"></div>
    
    <div class="btn-group">
        <button class="primary-btn" onclick="downloadQR()">Save QR</button>
        <button class="primary-btn" onclick="downloadVCard()">Save Contact</button>
    </div>
    <button class="reset-btn" onclick="resetForm()">Clear</button>
</div>

<script>
    const qrContainer = document.getElementById("qrcode");
    const qrcode = new QRCode(qrContainer, { width: 220, height: 220, colorDark: "#002D62", correctLevel: QRCode.CorrectLevel.L });

    // This is a placeholder for your image. For technical reasons, we'll use a small trick 
    // to link the photo.
    const PHOTO_URL = "https://raw.githubusercontent.com/monkeyjedi/PewBusCards/main/Pew_Background-2023-2%20.png";

    function getVCardData() {
        const fn = document.getElementById("fname").value;
        const ln = document.getElementById("lname").value;
        const pro = document.getElementById("pro").value;
        const comp = document.getElementById("comp").value;
        const title = document.getElementById("title").value;
        const email = document.getElementById("email").value;
        const phone = document.getElementById("phone").value;
        const li = document.getElementById("li").value;

        // Structured vCard 3.0
        return [
            "BEGIN:VCARD",
            "VERSION:3.0",
            `N:${ln};${fn};;;`,
            `FN:${fn} ${ln}${pro ? ' ('+pro+')' : ''}`,
            `ORG:${comp}`,
            `TITLE:${title}`,
            `EMAIL;TYPE=INTERNET,WORK:${email}`,
            `TEL;TYPE=CELL,VOICE:${phone}`,
            `URL:${li}`,
            `X-PRONOUNS:${pro}`,
            `GENDER:${pro}`, // Backup for Android/Older iOS
            `PHOTO;VALUE=URI:${PHOTO_URL}`,
            "END:VCARD"
        ].join("\n");
    }

    function generateQR() {
        const data = getVCardData();
        if(document.getElementById("fname").value || document.getElementById("lname").value) {
            qrcode.clear();
            qrcode.makeCode(data);
        }
    }

    function downloadQR() {
        const img = qrContainer.querySelector("img");
        if(img) {
            const link = document.createElement("a");
            link.href = img.src; link.download = "Pew_Contact_QR.png"; link.click();
        }
    }

    function downloadVCard() {
        const data = getVCardData();
        const file = new Blob([data], { type: 'text/vcard;charset=utf-8' });
        const url = URL.createObjectURL(file);
        const link = document.createElement("a");
        link.href = url;
        link.download = `${document.getElementById("fname").value || 'Pew'}_Contact.vcf`;
        link.click();
    }

    function resetForm() {
        document.querySelectorAll('input').forEach(i => i.id === 'comp' ? i.value = 'Pew' : i.value = '');
        qrcode.makeCode("Enter details to start");
    }

    qrcode.makeCode("Enter details to start");
</script>

</body>
</html>
